package com.lggh.controller.sphz.project;

import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import javax.annotation.Resource;
import javax.servlet.http.HttpServletRequest;

import org.apache.shiro.crypto.hash.SimpleHash;
import org.bson.Document;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.multipart.MultipartFile;
import org.springframework.web.servlet.ModelAndView;

import com.lggh.controller.base.BaseController;
import com.lggh.entity.system.Dictionaries;
import com.lggh.entity.system.Role;
import com.lggh.service.sphz.BuildingManager;
import com.lggh.service.sphz.ChangeManager;
import com.lggh.service.sphz.FileManager;
import com.lggh.service.sphz.MessageManager;
import com.lggh.service.sphz.OpinionsManager;
import com.lggh.service.sphz.PcompletionManager;
import com.lggh.service.sphz.PpermitionManager;
import com.lggh.service.sphz.ProjManager;
import com.lggh.service.sphz.TrafficManager;
import com.lggh.service.system.dictionaries.DictionariesManager;
import com.lggh.util.AppUtil;
import com.lggh.util.Const;
import com.lggh.util.ConvertUtil;
import com.lggh.util.FilePageData;
import com.lggh.util.FileUpload;
import com.lggh.util.FtpUtils;
import com.lggh.util.GetPinyin;
import com.lggh.util.Jurisdiction;
import com.lggh.util.MongoDBUtil;
import com.lggh.util.ObjectExcelRead;
import com.lggh.util.PageData;
import com.lggh.util.PathUtil;
import com.lggh.util.SphzUtils;
import com.lggh.util.Tools;
import com.mongodb.MongoClient;
import com.mongodb.client.FindIterable;
import com.mongodb.client.model.UpdateOptions;

import net.sf.json.JSONArray;

@Controller
@RequestMapping("/sphz/project")
public class ProjectController extends BaseController {
	@Resource(name="fileService")
	private FileManager fileService;
	@Resource(name="dictionariesService")
	private DictionariesManager dictionariesService;
	
	private MongoClient mongoClient;
	Map<String, Object> propsMap = FtpUtils.getFtpProperties();
	String hostname = (String) propsMap.get("host");
	int port = Integer.parseInt((String) propsMap.get("port"));
	String username = (String) propsMap.get("username");
	String password = (String) propsMap.get("password");
	
	/**
	 * 去新增发证信息页面
	 * @return
	 * @throws Exception 
	 */
	@RequestMapping(value="/goAdd")
	public ModelAndView goAdd() throws Exception{
		ModelAndView mv = this.getModelAndView();
		PageData pd = new PageData();
		
		//用地性质树形选择
		List<PageData> zdictPdList = new ArrayList<PageData>();
		JSONArray arr = JSONArray.fromObject(dictionariesService.listAllDictsToSelect("c7fa42b047ef49bca1100d3fc636f533",zdictPdList));
		mv.addObject("zTreeNodes", (null == arr ?"":arr.toString()));
		
		pd.put("BIANMA", "009");
		List<Dictionaries> jzwsyxzList = dictionariesService.listAllItemsByCodeValue(pd);//列出所有建筑物使用性质
		mv.addObject("jzwsyxzList", jzwsyxzList);
		
		pd.put("BIANMA","015");
		List<Dictionaries> ssqhList = dictionariesService.listAllItemsByCodeValue(pd);//列出所有所属区划
		mv.addObject("ssqhList", ssqhList);
		
		pd.put("BIANMA","019");
		List<Dictionaries> sfhhydList = dictionariesService.listAllItemsByCodeValue(pd);//列出所有是否混合用地
		mv.addObject("sfhhydList", sfhhydList);
		
		mv.addObject("pd",pd);
		mv.addObject("msg", "add");
		mv.addObject("title", "项目登记");
		mv.setViewName("sphz/project/project_edit");
		return mv;
	}
	
	@RequestMapping(value="/add")
	@ResponseBody
	public Object save(HttpServletRequest request) throws Exception{
		Map<String,Object> map = new HashMap<String,Object>();
		String errInfo = "success";
		String PROJ_ID=this.get32UUID();
		FilePageData pd = new FilePageData(request);
		pd.put("PROJ_ID",PROJ_ID);
		pd.put("PROJ_TBR",Jurisdiction.getUsername());
		pd.put("PROJ_TBBM",Jurisdiction.getUsername());
		SimpleDateFormat df1=new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
		pd.put("PROJ_TBRQ",df1.format(System.currentTimeMillis()));
		try {
			mongoClient = MongoDBUtil.initMongo();
			Document document = ConvertUtil.convertDocByMap(pd);
			System.out.println(MongoDBUtil.getDbName());
			mongoClient.getDatabase(MongoDBUtil.getDbName()).getCollection("xiangmu")
					.insertOne(document);
			//添加红线文件
			SphzUtils.uploadFile(request, PROJ_ID, "redFile", "redbasepath", 2, fileService);//红线范围
			mongoClient.close();
		} catch (Exception e) {
			errInfo=e.toString();
		}
		map.put("result", errInfo);				//返回结果
		return AppUtil.returnObject(new PageData(), map);
	}
	
	/**
	 * 去项目列表页面
	 * @return
	 * @throws Exception 
	 */
	@RequestMapping(value="/goList")
	public ModelAndView goList() throws Exception{
		ModelAndView mv = this.getModelAndView();
		PageData pd = new PageData();
		mv.setViewName("sphz/project/project_list");
		return mv;
	}
	
	/**
	 * 获取项目列表
	 * @return
	 * @throws Exception 
	 */
	@RequestMapping(value="/list")
	@ResponseBody
	public Object list() throws Exception{
		
		Map<String,Object> map = new HashMap<String,Object>();
		String errInfo = "success"; 
		PageData pd = new PageData();
		List<Map<String, Object>> projList=new ArrayList<Map<String,Object>>();
		
		try{
			pd = this.getPageData();
			Integer sEcho=Integer.parseInt(pd.getString("sEcho"));
			Integer iDisplayStart =Integer.parseInt(pd.getString("iDisplayStart"));
			Integer iDisplayLength =Integer.parseInt(pd.getString("iDisplayLength"));
			pd.put("DEPARTMENT",Jurisdiction.getUsername());
			System.out.println(pd);
			mongoClient = MongoDBUtil.initMongo();
			Document document = new Document();
			document.append("PROJ_TBRQ", -1);
			FindIterable<Document> documents  = mongoClient.getDatabase(MongoDBUtil.getDbName()).getCollection("xiangmu")
					.find().sort(document).skip(iDisplayStart).limit(iDisplayLength);
			long count = mongoClient.getDatabase(MongoDBUtil.getDbName()).getCollection("xiangmu")
			.count();
			Integer intValue = new Long(count).intValue();
			//int initEcho=sEcho+1;
			projList = MongoDBUtil.documents2MapList(documents);
			map.put("iDisplayStart",iDisplayStart);
			map.put("iDisplayLength",iDisplayLength);
			map.put("sEcho", sEcho);
			map.put("iTotalRecords", intValue);
			map.put("iTotalDisplayRecords", intValue);//显示的条数 
			mongoClient.close();
		} catch(Exception e){
			errInfo=e.toString();
			logger.error(e.toString(), e);
		}
		map.put("projList", projList);
		map.put("result", errInfo);				//返回结果
		return AppUtil.returnObject(new PageData(), map);
	}
	
	/**
	 * 获取项目列表
	 * @return
	 * @throws Exception 
	 */
	@RequestMapping(value="/list1")
	@ResponseBody
	public Object list1() throws Exception{
		
		Map<String,Object> map = new HashMap<String,Object>();
		String errInfo = "success"; 
		PageData pd = new PageData();
		List<Map<String, Object>> projList=new ArrayList<Map<String,Object>>();
		
		try{
			pd = this.getPageData();
			System.out.println(pd);
			Integer start=Integer.parseInt(pd.getString("start"));
			Integer length =Integer.parseInt(pd.getString("length"));
			Integer draw =Integer.parseInt(pd.getString("draw"));
			draw++;
			pd.put("DEPARTMENT",Jurisdiction.getUsername());
			System.out.println(pd);
			mongoClient = MongoDBUtil.initMongo();
			Document document = new Document();
			document.append("PROJ_TBRQ", -1);
			FindIterable<Document> documents  = mongoClient.getDatabase(MongoDBUtil.getDbName()).getCollection("xiangmu")
					.find().sort(document).skip(start).limit(length);
			long count = mongoClient.getDatabase(MongoDBUtil.getDbName()).getCollection("xiangmu")
			.count();
			Integer intValue = new Long(count).intValue();
			//int initEcho=sEcho+1;
			projList = MongoDBUtil.documents2MapList(documents);
			map.put("start",start);
			map.put("length",length);
			map.put("draw", draw);
			map.put("recordsTotal", intValue);
			map.put("recordsFiltered", intValue);//显示的条数 
			mongoClient.close();
		} catch(Exception e){
			errInfo=e.toString();
			logger.error(e.toString(), e);
		}
		map.put("projList", projList);
		map.put("result", errInfo);				//返回结果
		return AppUtil.returnObject(new PageData(), map);
	}
	
	/**
	 * 根据proj_key获取项目
	 * @return
	 * @throws Exception 
	 */
	@RequestMapping(value="/getProjByKey")
	@ResponseBody
	public Object getProjByKey() throws Exception{
		
		Map<String,Object> map = new HashMap<String,Object>();
		String errInfo = "success"; 
		PageData pd = new PageData();
		List<Map<String, Object>> projList=new ArrayList<Map<String,Object>>();
		List<Map<String, Object>> projList1=new ArrayList<Map<String,Object>>();
		try{
			pd = this.getPageData();
	
			mongoClient = MongoDBUtil.initMongo();
			Document document = new Document();
			document.append("PROJ_KEY", pd.get("PROJ_KEY"));
			FindIterable<Document> documents  = mongoClient.getDatabase(MongoDBUtil.getDbName()).getCollection("xiangmu")
					.find(document).projection(new Document("_id",0));
			projList = MongoDBUtil.documents2MapList(documents);
			mongoClient.close();
			projList1= SphzUtils.projLeftJoinDic(dictionariesService, projList);
			

		} catch(Exception e){
			errInfo=e.toString();
			logger.error(e.toString(), e);
		}
		
		
		map.put("projList", projList1);
		map.put("result", errInfo);				//返回结果
		return AppUtil.returnObject(new PageData(), map);
	}
	
	/**打开上传EXCEL页面
	 * @return
	 * @throws Exception
	 */
	@RequestMapping(value="/goUploadExcel")
	public ModelAndView goUploadExcel()throws Exception{
		ModelAndView mv = this.getModelAndView();
		mv.setViewName("sphz/project/file_upload");
		return mv;
	}
	
	
	/**从EXCEL导入到数据库项目表
	 * @param file
	 * @return
	 * @throws Exception
	 */
	@RequestMapping(value="/readExcelXiangmu")
	public ModelAndView readExcelXiangmu(
			@RequestParam(value="planFile",required=false) MultipartFile file
			) throws Exception{
		ModelAndView mv = this.getModelAndView();
		PageData pd = new PageData();
		if (null != file && !file.isEmpty()) {
			String filePath = PathUtil.getClasspath() + Const.FILEPATHFILE;								//文件上传路径
			String fileName =  FileUpload.fileUp(file, filePath, "fawenexcel");							//执行上传
			List<PageData> listPd = (List)ObjectExcelRead.readExcel(filePath, fileName, 1, 0, 0);		//执行读EXCEL操作,读出的数据导入List 2:从第3行开始；0:从第A列开始；0:第0个sheet
	
			/**
			 * var0 :项目唯一码
			 * var1 :项目编号
			 * var2 :项目名称
			 * var3 :项目位置
			 * var4 :建设单位
			 * var5 :所属区划
			 * var6 :规划用地性质
			 * var7 :是否混合用地
			 * var8 :混合比例
			 * var9 :建筑物使用性质
			 * var10 :备注
			 */
			mongoClient = MongoDBUtil.initMongo();
			for(int i=0;i<listPd.size();i++){		
				pd.put("XIANGMU_ID", this.get32UUID());										//ID
				pd.put("XMWYM", listPd.get(i).getString("var0"));							
				pd.put("XMBH", listPd.get(i).getString("var1"));	
				pd.put("XMMC", listPd.get(i).getString("var2"));	
				pd.put("XMWZ", listPd.get(i).getString("var3"));		
				pd.put("JSDW", listPd.get(i).getString("var4"));							
				pd.put("SSQH", listPd.get(i).getString("var5"));	
				pd.put("GHYDXZ", listPd.get(i).getString("var6"));	
				pd.put("SFHHYD", listPd.get(i).getString("var7"));		
				pd.put("HHBL", listPd.get(i).getString("var8"));							
				pd.put("JZWSYXZ", listPd.get(i).getString("var9"));	
				pd.put("BZ", listPd.get(i).getString("var10"));	
				Document document = ConvertUtil.convertDocByMap(pd);
				System.out.println(MongoDBUtil.getDbName());
				mongoClient.getDatabase(MongoDBUtil.getDbName()).getCollection("xiangmu")
						.insertOne(document);
			}
			mongoClient.close();
			/*存入数据库操作======================================*/
			mv.addObject("msg","success");
		}
		mv.setViewName("save_result");
		return mv;
	}
	
	

	/**从EXCEL导入到数据库核字（道桥）
	 * @param file
	 * @return
	 * @throws Exception
	 */
	@RequestMapping(value="/readExcelHZDQ")
	public ModelAndView readExcelHZDQ(
			@RequestParam(value="planFile",required=false) MultipartFile file
			) throws Exception{
		ModelAndView mv = this.getModelAndView();
		PageData pd = new PageData();
		if (null != file && !file.isEmpty()) {
			String filePath = PathUtil.getClasspath() + Const.FILEPATHFILE;								//文件上传路径
			String fileName =  FileUpload.fileUp(file, filePath, "fawenexcel");							//执行上传
			List<PageData> listPd = (List)ObjectExcelRead.readExcel(filePath, fileName, 1, 0, 0);		//执行读EXCEL操作,读出的数据导入List 2:从第3行开始；0:从第A列开始；0:第0个sheet
	
			/**
			 * var0 :项目唯一码
			 * var1 :文号唯一吗
			 * var2 :项目编号
			 * var3 :受理编号
			 * var4 :受理日期
			 * var5 :发文文号
			 * var6 :发文日期
			 * var7 :证书钢印号
			 * var8 :申办类型
			 * var9 :审批阶段
			 * var10 :工程类别
			 * var11 :项目类型
			 * var12 :承办部门
			 * var13 :经办人
			 * var14 :签批人
			 * var15 :发文类型
			 * var16 :项目名称
			 * var17 :项目位置
			 * var18 :建设单位
			 * var19 :组织机构代码证
			 * var20 :报建人
			 * var21 :联系方式
			 * var22 :设计单位
			 * var23 :规划用地性质
			 * var24 :混合用地性质
			 * var25 :档案编号
			 * var26 :档案盒号
			 * var27 :档案来源
			 * var28 :录入人员
			 * var29 :审核人员
			 * var30 :录入日期
			 * var31 :审核日期
			 * var32 :审核状态
			 * var33 :备注
			 * var34 :道路类型
			 * var35 :道路长度
			 * var36 :红线宽度
			 * var37 :折算建筑面积
			 * var38 :海绵城市要求
	
			 */
			mongoClient = MongoDBUtil.initMongo();
			for(int i=0;i<listPd.size();i++){		
				pd.put("FAWEN_ID", this.get32UUID());										//ID
				pd.put("XMWYM", listPd.get(i).getString("var0"));							
				pd.put("WHWYM", listPd.get(i).getString("var1"));	
				pd.put("XMBH", listPd.get(i).getString("var2"));	
				pd.put("SLBH", listPd.get(i).getString("var3"));		
				pd.put("SLRQ", listPd.get(i).getString("var4"));							
				pd.put("FWWH", listPd.get(i).getString("var5"));	
				pd.put("FWRQ", listPd.get(i).getString("var6"));	
				pd.put("ZSGYH", listPd.get(i).getString("var7"));		
				pd.put("SBLX", listPd.get(i).getString("var8"));							
				pd.put("SPJD", listPd.get(i).getString("var9"));	
				pd.put("GCLB", listPd.get(i).getString("var10"));	
				pd.put("XMLX", listPd.get(i).getString("var11"));		
				pd.put("CBBM", listPd.get(i).getString("var12"));							
				pd.put("JBR", listPd.get(i).getString("var13"));	
				pd.put("QPR", listPd.get(i).getString("var14"));	
				pd.put("FWLX", listPd.get(i).getString("var15"));
				pd.put("XMMC", listPd.get(i).getString("var16"));							
				pd.put("XMWZ", listPd.get(i).getString("var17"));	
				pd.put("JSDW", listPd.get(i).getString("var18"));	
				pd.put("ZZJGDM", listPd.get(i).getString("var19"));		
				pd.put("BJR", listPd.get(i).getString("var20"));							
				pd.put("LXFS", listPd.get(i).getString("var21"));	
				pd.put("SJDW", listPd.get(i).getString("var22"));	
				pd.put("GHYDXZ", listPd.get(i).getString("var23"));		
				pd.put("HHYDXZ", listPd.get(i).getString("var24"));							
				pd.put("DABH", listPd.get(i).getString("var25"));	
				pd.put("DAHH", listPd.get(i).getString("var26"));	
				pd.put("DALY", listPd.get(i).getString("var27"));		
				pd.put("LRRY", listPd.get(i).getString("var28"));							
				pd.put("SHRY", listPd.get(i).getString("var29"));	
				pd.put("LRRQ", listPd.get(i).getString("var30"));	
				pd.put("SHRQ", listPd.get(i).getString("var31"));
				
				pd.put("SHZT", listPd.get(i).getString("var32"));	
				pd.put("BZ", listPd.get(i).getString("var33"));		
				pd.put("DLLX", listPd.get(i).getString("var34"));							
				pd.put("DLCD", listPd.get(i).getString("var35"));	
				pd.put("HXKD", listPd.get(i).getString("var36"));	
				pd.put("ZSJZMJ", listPd.get(i).getString("var37"));		
				pd.put("HMCSYQ", listPd.get(i).getString("var38"));							
				SimpleDateFormat df1=new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
				pd.put("DRSJ",df1.format(System.currentTimeMillis()));
				pd.put("FWLXID","b64538bb9488464d95adef42eb29919d");
				Document document = ConvertUtil.convertDocByMap(pd);
				System.out.println(MongoDBUtil.getDbName());
				mongoClient.getDatabase(MongoDBUtil.getDbName()).getCollection("fawen")
						.insertOne(document);
			}
			mongoClient.close();
			/*存入数据库操作======================================*/
			mv.addObject("msg","success");
		}
		mv.setViewName("save_result");
		return mv;
	}
	
	/**从EXCEL导入到数据库核字（管线）
	 * @param file
	 * @return
	 * @throws Exception
	 */
	@RequestMapping(value="/readExcelHZGX")
	public ModelAndView readExcelHZGX(
			@RequestParam(value="planFile",required=false) MultipartFile file
			) throws Exception{
		ModelAndView mv = this.getModelAndView();
		PageData pd = new PageData();
		if (null != file && !file.isEmpty()) {
			String filePath = PathUtil.getClasspath() + Const.FILEPATHFILE;								//文件上传路径
			String fileName =  FileUpload.fileUp(file, filePath, "fawenexcel");							//执行上传
			List<PageData> listPd = (List)ObjectExcelRead.readExcel(filePath, fileName, 1, 0, 0);		//执行读EXCEL操作,读出的数据导入List 2:从第3行开始；0:从第A列开始；0:第0个sheet
	
			/**
			 * var0 :项目唯一码
			 * var1 :文号唯一吗
			 * var2 :项目编号
			 * var3 :受理编号
			 * var4 :受理日期
			 * var5 :发文文号
			 * var6 :发文日期
			 * var7 :证书钢印号
			 * var8 :申办类型
			 * var9 :审批阶段
			 * var10 :工程类别
			 * var11 :项目类型
			 * var12 :承办部门
			 * var13 :经办人
			 * var14 :签批人
			 * var15 :发文类型
			 * var16 :项目名称
			 * var17 :项目位置
			 * var18 :建设单位
			 * var19 :组织机构代码证
			 * var20 :报建人
			 * var21 :联系方式
			 * var22 :设计单位
			 * var23 :规划用地性质
			 * var24 :混合用地性质
			 * var25 :档案编号
			 * var26 :档案盒号
			 * var27 :档案来源
			 * var28 :录入人员
			 * var29 :审核人员
			 * var30 :录入日期
			 * var31 :审核日期
			 * var32 :审核状态
			 * var33 :备注
			 * var34 :道路类型
			 * var35 :道路长度
			 * var36 :红线宽度
			 * var37 :折算建筑面积
			 * var38 :海绵城市要求
	
			 */
			mongoClient = MongoDBUtil.initMongo();
			for(int i=0;i<listPd.size();i++){		
				pd.put("FAWEN_ID", this.get32UUID());										//ID
				pd.put("XMWYM", listPd.get(i).getString("var0"));							
				pd.put("WHWYM", listPd.get(i).getString("var1"));	
				pd.put("XMBH", listPd.get(i).getString("var2"));	
				pd.put("SLBH", listPd.get(i).getString("var3"));		
				pd.put("SLRQ", listPd.get(i).getString("var4"));							
				pd.put("FWWH", listPd.get(i).getString("var5"));	
				pd.put("FWRQ", listPd.get(i).getString("var6"));	
				pd.put("ZSGYH", listPd.get(i).getString("var7"));		
				pd.put("SBLX", listPd.get(i).getString("var8"));							
				pd.put("SPJD", listPd.get(i).getString("var9"));	
				pd.put("GCLB", listPd.get(i).getString("var10"));	
				pd.put("XMLX", listPd.get(i).getString("var11"));		
				pd.put("CBBM", listPd.get(i).getString("var12"));							
				pd.put("JBR", listPd.get(i).getString("var13"));	
				pd.put("QPR", listPd.get(i).getString("var14"));	
				pd.put("FWLX", listPd.get(i).getString("var15"));
				pd.put("XMMC", listPd.get(i).getString("var16"));							
				pd.put("XMWZ", listPd.get(i).getString("var17"));	
				pd.put("JSDW", listPd.get(i).getString("var18"));	
				pd.put("ZZJGDM", listPd.get(i).getString("var19"));		
				pd.put("BJR", listPd.get(i).getString("var20"));							
				pd.put("LXFS", listPd.get(i).getString("var21"));	
				pd.put("SJDW", listPd.get(i).getString("var22"));	
				pd.put("GHYDXZ", listPd.get(i).getString("var23"));		
				pd.put("HHYDXZ", listPd.get(i).getString("var24"));							
				pd.put("DABH", listPd.get(i).getString("var25"));	
				pd.put("DAHH", listPd.get(i).getString("var26"));	
				pd.put("DALY", listPd.get(i).getString("var27"));		
				pd.put("LRRY", listPd.get(i).getString("var28"));							
				pd.put("SHRY", listPd.get(i).getString("var29"));	
				pd.put("LRRQ", listPd.get(i).getString("var30"));	
				pd.put("SHRQ", listPd.get(i).getString("var31"));
				
				pd.put("SHZT", listPd.get(i).getString("var32"));	
				pd.put("BZ", listPd.get(i).getString("var33"));		
				pd.put("GXLX", listPd.get(i).getString("var34"));							
				pd.put("GXCD", listPd.get(i).getString("var35"));	
				pd.put("HMCSYQ", listPd.get(i).getString("var36"));							
				SimpleDateFormat df1=new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
				pd.put("DRSJ",df1.format(System.currentTimeMillis()));
				pd.put("FWLXID","f8063ade57ca4f539e0007e3d4cfd8aa");
				Document document = ConvertUtil.convertDocByMap(pd);
				System.out.println(MongoDBUtil.getDbName());
				mongoClient.getDatabase(MongoDBUtil.getDbName()).getCollection("fawen")
						.insertOne(document);
			}
			mongoClient.close();
			/*存入数据库操作======================================*/
			mv.addObject("msg","success");
		}
		mv.setViewName("save_result");
		return mv;
	}
	
	/**从EXCEL导入到数据库核字（建筑）
	 * @param file
	 * @return
	 * @throws Exception
	 */
	@RequestMapping(value="/readExcelHZJZ")
	public ModelAndView readExcelHZJZ(
			@RequestParam(value="planFile",required=false) MultipartFile file
			) throws Exception{
		ModelAndView mv = this.getModelAndView();
		PageData pd = new PageData();
		if (null != file && !file.isEmpty()) {
			String filePath = PathUtil.getClasspath() + Const.FILEPATHFILE;								//文件上传路径
			String fileName =  FileUpload.fileUp(file, filePath, "fawenexcel");							//执行上传
			List<PageData> listPd = (List)ObjectExcelRead.readExcel(filePath, fileName, 1, 0, 0);		//执行读EXCEL操作,读出的数据导入List 2:从第3行开始；0:从第A列开始；0:第0个sheet
	
			/**
			 * var0 :项目唯一码
			 * var1 :文号唯一吗
			 * var2 :项目编号
			 * var3 :受理编号
			 * var4 :受理日期
			 * var5 :发文文号
			 * var6 :发文日期
			 * var7 :证书钢印号
			 * var8 :申办类型
			 * var9 :审批阶段
			 * var10 :工程类别
			 * var11 :项目类型
			 * var12 :承办部门
			 * var13 :经办人
			 * var14 :签批人
			 * var15 :发文类型
			 * var16 :项目名称
			 * var17 :项目位置
			 * var18 :建设单位
			 * var19 :组织机构代码证
			 * var20 :报建人
			 * var21 :联系方式
			 * var22 :设计单位
			 * var23 :规划用地性质
			 * var24 :混合用地性质
			 * var25 :档案编号
			 * var26 :档案盒号
			 * var27 :档案来源
			 * var28 :录入人员
			 * var29 :审核人员
			 * var30 :录入日期
			 * var31 :审核日期
			 * var32 :审核状态
			 * var33 :备注
			 * var34 :道路类型
			 * var35 :道路长度
			 * var36 :红线宽度
			 * var37 :折算建筑面积
			 * var38 :海绵城市要求
	
			 */
			mongoClient = MongoDBUtil.initMongo();
			for(int i=0;i<listPd.size();i++){		
				pd.put("FAWEN_ID", this.get32UUID());										//ID
				pd.put("XMWYM", listPd.get(i).getString("var0"));							
				pd.put("WHWYM", listPd.get(i).getString("var1"));	
				pd.put("XMBH", listPd.get(i).getString("var2"));	
				pd.put("SLBH", listPd.get(i).getString("var3"));		
				pd.put("SLRQ", listPd.get(i).getString("var4"));							
				pd.put("FWWH", listPd.get(i).getString("var5"));	
				pd.put("FWRQ", listPd.get(i).getString("var6"));	
				pd.put("ZSGYH", listPd.get(i).getString("var7"));		
				pd.put("SBLX", listPd.get(i).getString("var8"));							
				pd.put("SPJD", listPd.get(i).getString("var9"));	
				pd.put("GCLB", listPd.get(i).getString("var10"));	
				pd.put("XMLX", listPd.get(i).getString("var11"));		
				pd.put("CBBM", listPd.get(i).getString("var12"));							
				pd.put("JBR", listPd.get(i).getString("var13"));	
				pd.put("QPR", listPd.get(i).getString("var14"));	
				pd.put("FWLX", listPd.get(i).getString("var15"));
				pd.put("XMMC", listPd.get(i).getString("var16"));							
				pd.put("XMWZ", listPd.get(i).getString("var17"));	
				pd.put("JSDW", listPd.get(i).getString("var18"));	
				pd.put("ZZJGDM", listPd.get(i).getString("var19"));		
				pd.put("BJR", listPd.get(i).getString("var20"));							
				pd.put("LXFS", listPd.get(i).getString("var21"));	
				pd.put("SJDW", listPd.get(i).getString("var22"));	
				pd.put("GHYDXZ", listPd.get(i).getString("var23"));		
				pd.put("HHYDXZ", listPd.get(i).getString("var24"));							
				pd.put("DABH", listPd.get(i).getString("var25"));	
				pd.put("DAHH", listPd.get(i).getString("var26"));	
				pd.put("DALY", listPd.get(i).getString("var27"));		
				pd.put("LRRY", listPd.get(i).getString("var28"));							
				pd.put("SHRY", listPd.get(i).getString("var29"));	
				pd.put("LRRQ", listPd.get(i).getString("var30"));	
				pd.put("SHRQ", listPd.get(i).getString("var31"));
				pd.put("SHZT", listPd.get(i).getString("var32"));	
				pd.put("BZ", listPd.get(i).getString("var33"));	
				
				pd.put("ZJZMJ", listPd.get(i).getString("var34"));							
				pd.put("DSJZMJ", listPd.get(i).getString("var35"));	
				pd.put("DXJZMJ", listPd.get(i).getString("var36"));
				pd.put("HMCSYQ", listPd.get(i).getString("var37"));
				
				SimpleDateFormat df1=new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
				pd.put("DRSJ",df1.format(System.currentTimeMillis()));
				pd.put("FWLXID","35a5faa9f3554416b0283861b2ab283b");
				Document document = ConvertUtil.convertDocByMap(pd);
				System.out.println(MongoDBUtil.getDbName());
				mongoClient.getDatabase(MongoDBUtil.getDbName()).getCollection("fawen")
						.insertOne(document);
			}
			mongoClient.close();
			/*存入数据库操作======================================*/
			mv.addObject("msg","success");
		}
		mv.setViewName("save_result");
		return mv;
	}
	
	/**从EXCEL导入到数据库建字（道桥）
	 * @param file
	 * @return
	 * @throws Exception
	 */
	@RequestMapping(value="/readExcelJZDQ")
	public ModelAndView readExcelJZDQ(
			@RequestParam(value="planFile",required=false) MultipartFile file
			) throws Exception{
		ModelAndView mv = this.getModelAndView();
		PageData pd = new PageData();
		if (null != file && !file.isEmpty()) {
			String filePath = PathUtil.getClasspath() + Const.FILEPATHFILE;								//文件上传路径
			String fileName =  FileUpload.fileUp(file, filePath, "fawenexcel");							//执行上传
			List<PageData> listPd = (List)ObjectExcelRead.readExcel(filePath, fileName, 1, 0, 0);		//执行读EXCEL操作,读出的数据导入List 2:从第3行开始；0:从第A列开始；0:第0个sheet
	
			/**
			 * var0 :项目唯一码
			 * var1 :文号唯一吗
			 * var2 :项目编号
			 * var3 :受理编号
			 * var4 :受理日期
			 * var5 :发文文号
			 * var6 :发文日期
			 * var7 :证书钢印号
			 * var8 :申办类型
			 * var9 :审批阶段
			 * var10 :工程类别
			 * var11 :项目类型
			 * var12 :承办部门
			 * var13 :经办人
			 * var14 :签批人
			 * var15 :发文类型
			 * var16 :项目名称
			 * var17 :项目位置
			 * var18 :建设单位
			 * var19 :组织机构代码证
			 * var20 :报建人
			 * var21 :联系方式
			 * var22 :设计单位
			 * var23 :规划用地性质
			 * var24 :混合用地性质
			 * var25 :档案编号
			 * var26 :档案盒号
			 * var27 :档案来源
			 * var28 :录入人员
			 * var29 :审核人员
			 * var30 :录入日期
			 * var31 :审核日期
			 * var32 :审核状态
			 * var33 :备注
			 * var34 :道路类型
			 * var35 :道路长度
			 * var36 :红线宽度
			 * var37 :折算建筑面积
			 * var38 :海绵城市要求
	
			 */
			mongoClient = MongoDBUtil.initMongo();
			for(int i=0;i<listPd.size();i++){		
				pd.put("FAWEN_ID", this.get32UUID());										//ID
				pd.put("XMWYM", listPd.get(i).getString("var0"));							
				pd.put("WHWYM", listPd.get(i).getString("var1"));	
				pd.put("XMBH", listPd.get(i).getString("var2"));	
				pd.put("SLBH", listPd.get(i).getString("var3"));		
				pd.put("SLRQ", listPd.get(i).getString("var4"));							
				pd.put("FWWH", listPd.get(i).getString("var5"));	
				pd.put("FWRQ", listPd.get(i).getString("var6"));	
				pd.put("ZSGYH", listPd.get(i).getString("var7"));		
				pd.put("SBLX", listPd.get(i).getString("var8"));							
				pd.put("SPJD", listPd.get(i).getString("var9"));	
				pd.put("GCLB", listPd.get(i).getString("var10"));	
				pd.put("XMLX", listPd.get(i).getString("var11"));		
				pd.put("CBBM", listPd.get(i).getString("var12"));							
				pd.put("JBR", listPd.get(i).getString("var13"));	
				pd.put("QPR", listPd.get(i).getString("var14"));	
				pd.put("FWLX", listPd.get(i).getString("var15"));
				pd.put("XMMC", listPd.get(i).getString("var16"));							
				pd.put("XMWZ", listPd.get(i).getString("var17"));	
				pd.put("JSDW", listPd.get(i).getString("var18"));	
				pd.put("ZZJGDM", listPd.get(i).getString("var19"));		
				pd.put("BJR", listPd.get(i).getString("var20"));							
				pd.put("LXFS", listPd.get(i).getString("var21"));	
				pd.put("SJDW", listPd.get(i).getString("var22"));	
				pd.put("GHYDXZ", listPd.get(i).getString("var23"));		
				pd.put("HHYDXZ", listPd.get(i).getString("var24"));							
				pd.put("DABH", listPd.get(i).getString("var25"));	
				pd.put("DAHH", listPd.get(i).getString("var26"));	
				pd.put("DALY", listPd.get(i).getString("var27"));		
				pd.put("LRRY", listPd.get(i).getString("var28"));							
				pd.put("SHRY", listPd.get(i).getString("var29"));	
				pd.put("LRRQ", listPd.get(i).getString("var30"));	
				pd.put("SHRQ", listPd.get(i).getString("var31"));
				pd.put("SHZT", listPd.get(i).getString("var32"));	
				pd.put("BZ", listPd.get(i).getString("var33"));	
				
				pd.put("DLLX", listPd.get(i).getString("var34"));							
				pd.put("DLCD", listPd.get(i).getString("var35"));	
				pd.put("HXKD", listPd.get(i).getString("var36"));
				pd.put("ZSJZMJ", listPd.get(i).getString("var37"));
				pd.put("HMCSYQ", listPd.get(i).getString("var38"));
				
				SimpleDateFormat df1=new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
				pd.put("DRSJ",df1.format(System.currentTimeMillis()));
				pd.put("FWLXID","af1cef1c384f4b5387987f0bdc830724");
				Document document = ConvertUtil.convertDocByMap(pd);
				System.out.println(MongoDBUtil.getDbName());
				mongoClient.getDatabase(MongoDBUtil.getDbName()).getCollection("fawen")
						.insertOne(document);
			}
			mongoClient.close();
			/*存入数据库操作======================================*/
			mv.addObject("msg","success");
		}
		mv.setViewName("save_result");
		return mv;
	}
	
	/**从EXCEL导入到数据库建字（管线）
	 * @param file
	 * @return
	 * @throws Exception
	 */
	@RequestMapping(value="/readExcelJZGX")
	public ModelAndView readExcelJZGX(
			@RequestParam(value="planFile",required=false) MultipartFile file
			) throws Exception{
		ModelAndView mv = this.getModelAndView();
		PageData pd = new PageData();
		if (null != file && !file.isEmpty()) {
			String filePath = PathUtil.getClasspath() + Const.FILEPATHFILE;								//文件上传路径
			String fileName =  FileUpload.fileUp(file, filePath, "fawenexcel");							//执行上传
			List<PageData> listPd = (List)ObjectExcelRead.readExcel(filePath, fileName, 1, 0, 0);		//执行读EXCEL操作,读出的数据导入List 2:从第3行开始；0:从第A列开始；0:第0个sheet
	
			/**
			 * var0 :项目唯一码
			 * var1 :文号唯一吗
			 * var2 :项目编号
			 * var3 :受理编号
			 * var4 :受理日期
			 * var5 :发文文号
			 * var6 :发文日期
			 * var7 :证书钢印号
			 * var8 :申办类型
			 * var9 :审批阶段
			 * var10 :工程类别
			 * var11 :项目类型
			 * var12 :承办部门
			 * var13 :经办人
			 * var14 :签批人
			 * var15 :发文类型
			 * var16 :项目名称
			 * var17 :项目位置
			 * var18 :建设单位
			 * var19 :组织机构代码证
			 * var20 :报建人
			 * var21 :联系方式
			 * var22 :设计单位
			 * var23 :规划用地性质
			 * var24 :混合用地性质
			 * var25 :档案编号
			 * var26 :档案盒号
			 * var27 :档案来源
			 * var28 :录入人员
			 * var29 :审核人员
			 * var30 :录入日期
			 * var31 :审核日期
			 * var32 :审核状态
			 * var33 :备注
			 * var34 :道路类型
			 * var35 :道路长度
			 * var36 :红线宽度
			 * var37 :折算建筑面积
			 * var38 :海绵城市要求
	
			 */
			mongoClient = MongoDBUtil.initMongo();
			for(int i=0;i<listPd.size();i++){		
				pd.put("FAWEN_ID", this.get32UUID());										//ID
				pd.put("XMWYM", listPd.get(i).getString("var0"));							
				pd.put("WHWYM", listPd.get(i).getString("var1"));	
				pd.put("XMBH", listPd.get(i).getString("var2"));	
				pd.put("SLBH", listPd.get(i).getString("var3"));		
				pd.put("SLRQ", listPd.get(i).getString("var4"));							
				pd.put("FWWH", listPd.get(i).getString("var5"));	
				pd.put("FWRQ", listPd.get(i).getString("var6"));	
				pd.put("ZSGYH", listPd.get(i).getString("var7"));		
				pd.put("SBLX", listPd.get(i).getString("var8"));							
				pd.put("SPJD", listPd.get(i).getString("var9"));	
				pd.put("GCLB", listPd.get(i).getString("var10"));	
				pd.put("XMLX", listPd.get(i).getString("var11"));		
				pd.put("CBBM", listPd.get(i).getString("var12"));							
				pd.put("JBR", listPd.get(i).getString("var13"));	
				pd.put("QPR", listPd.get(i).getString("var14"));	
				pd.put("FWLX", listPd.get(i).getString("var15"));
				pd.put("XMMC", listPd.get(i).getString("var16"));							
				pd.put("XMWZ", listPd.get(i).getString("var17"));	
				pd.put("JSDW", listPd.get(i).getString("var18"));	
				pd.put("ZZJGDM", listPd.get(i).getString("var19"));		
				pd.put("BJR", listPd.get(i).getString("var20"));							
				pd.put("LXFS", listPd.get(i).getString("var21"));	
				pd.put("SJDW", listPd.get(i).getString("var22"));	
				pd.put("GHYDXZ", listPd.get(i).getString("var23"));		
				pd.put("HHYDXZ", listPd.get(i).getString("var24"));							
				pd.put("DABH", listPd.get(i).getString("var25"));	
				pd.put("DAHH", listPd.get(i).getString("var26"));	
				pd.put("DALY", listPd.get(i).getString("var27"));		
				pd.put("LRRY", listPd.get(i).getString("var28"));							
				pd.put("SHRY", listPd.get(i).getString("var29"));	
				pd.put("LRRQ", listPd.get(i).getString("var30"));	
				pd.put("SHRQ", listPd.get(i).getString("var31"));
				
				pd.put("SHZT", listPd.get(i).getString("var32"));	
				pd.put("BZ", listPd.get(i).getString("var33"));		
				pd.put("GXLX", listPd.get(i).getString("var34"));							
				pd.put("GXCD", listPd.get(i).getString("var35"));
				pd.put("ZSJZMJ", listPd.get(i).getString("var36"));
				pd.put("HMCSYQ", listPd.get(i).getString("var37"));							
				SimpleDateFormat df1=new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
				pd.put("DRSJ",df1.format(System.currentTimeMillis()));
				pd.put("FWLXID","424008dcbf0b4d80938883d31feafc93");
				Document document = ConvertUtil.convertDocByMap(pd);
				System.out.println(MongoDBUtil.getDbName());
				mongoClient.getDatabase(MongoDBUtil.getDbName()).getCollection("fawen")
						.insertOne(document);
			}
			mongoClient.close();
			/*存入数据库操作======================================*/
			mv.addObject("msg","success");
		}
		mv.setViewName("save_result");
		return mv;
	}
	
	/**从EXCEL导入到数据库建字（建筑）
	 * @param file
	 * @return
	 * @throws Exception
	 */
	@RequestMapping(value="/readExcelJZJZ")
	public ModelAndView readExcelJZJZ(
			@RequestParam(value="planFile",required=false) MultipartFile file
			) throws Exception{
		ModelAndView mv = this.getModelAndView();
		PageData pd = new PageData();
		if (null != file && !file.isEmpty()) {
			String filePath = PathUtil.getClasspath() + Const.FILEPATHFILE;								//文件上传路径
			String fileName =  FileUpload.fileUp(file, filePath, "fawenexcel");							//执行上传
			List<PageData> listPd = (List)ObjectExcelRead.readExcel(filePath, fileName, 1, 0, 0);		//执行读EXCEL操作,读出的数据导入List 2:从第3行开始；0:从第A列开始；0:第0个sheet
	
			/**
			 * var0 :项目唯一码
			 * var1 :文号唯一吗
			 * var2 :项目编号
			 * var3 :受理编号
			 * var4 :受理日期
			 * var5 :发文文号
			 * var6 :发文日期
			 * var7 :证书钢印号
			 * var8 :申办类型
			 * var9 :审批阶段
			 * var10 :工程类别
			 * var11 :项目类型
			 * var12 :承办部门
			 * var13 :经办人
			 * var14 :签批人
			 * var15 :发文类型
			 * var16 :项目名称
			 * var17 :项目位置
			 * var18 :建设单位
			 * var19 :组织机构代码证
			 * var20 :报建人
			 * var21 :联系方式
			 * var22 :设计单位
			 * var23 :规划用地性质
			 * var24 :混合用地性质
			 * var25 :档案编号
			 * var26 :档案盒号
			 * var27 :档案来源
			 * var28 :录入人员
			 * var29 :审核人员
			 * var30 :录入日期
			 * var31 :审核日期
			 * var32 :审核状态
			 * var33 :备注
			 * var34 :道路类型
			 * var35 :道路长度
			 * var36 :红线宽度
			 * var37 :折算建筑面积
			 * var38 :海绵城市要求
	
			 */
			mongoClient = MongoDBUtil.initMongo();
			for(int i=0;i<listPd.size();i++){		
				pd.put("FAWEN_ID", this.get32UUID());										//ID
				pd.put("XMWYM", listPd.get(i).getString("var0"));							
				pd.put("WHWYM", listPd.get(i).getString("var1"));	
				pd.put("XMBH", listPd.get(i).getString("var2"));	
				pd.put("SLBH", listPd.get(i).getString("var3"));		
				pd.put("SLRQ", listPd.get(i).getString("var4"));							
				pd.put("FWWH", listPd.get(i).getString("var5"));	
				pd.put("FWRQ", listPd.get(i).getString("var6"));	
				pd.put("ZSGYH", listPd.get(i).getString("var7"));		
				pd.put("SBLX", listPd.get(i).getString("var8"));							
				pd.put("SPJD", listPd.get(i).getString("var9"));	
				pd.put("GCLB", listPd.get(i).getString("var10"));	
				pd.put("XMLX", listPd.get(i).getString("var11"));		
				pd.put("CBBM", listPd.get(i).getString("var12"));							
				pd.put("JBR", listPd.get(i).getString("var13"));	
				pd.put("QPR", listPd.get(i).getString("var14"));	
				pd.put("FWLX", listPd.get(i).getString("var15"));
				pd.put("XMMC", listPd.get(i).getString("var16"));							
				pd.put("XMWZ", listPd.get(i).getString("var17"));	
				pd.put("JSDW", listPd.get(i).getString("var18"));	
				pd.put("ZZJGDM", listPd.get(i).getString("var19"));		
				pd.put("BJR", listPd.get(i).getString("var20"));							
				pd.put("LXFS", listPd.get(i).getString("var21"));	
				pd.put("SJDW", listPd.get(i).getString("var22"));	
				pd.put("GHYDXZ", listPd.get(i).getString("var23"));		
				pd.put("HHYDXZ", listPd.get(i).getString("var24"));							
				pd.put("DABH", listPd.get(i).getString("var25"));	
				pd.put("DAHH", listPd.get(i).getString("var26"));	
				pd.put("DALY", listPd.get(i).getString("var27"));		
				pd.put("LRRY", listPd.get(i).getString("var28"));							
				pd.put("SHRY", listPd.get(i).getString("var29"));	
				pd.put("LRRQ", listPd.get(i).getString("var30"));	
				pd.put("SHRQ", listPd.get(i).getString("var31"));
				pd.put("SHZT", listPd.get(i).getString("var32"));	
				pd.put("BZ", listPd.get(i).getString("var33"));	
				
				pd.put("YDMJ", listPd.get(i).getString("var34"));							
				pd.put("RJL", listPd.get(i).getString("var35"));	
				pd.put("JZMD", listPd.get(i).getString("var36"));
				pd.put("LDL", listPd.get(i).getString("var37"));
				pd.put("JZGD", listPd.get(i).getString("var38"));							
				pd.put("ZJZMJ", listPd.get(i).getString("var39"));	
				pd.put("DSJZMJ", listPd.get(i).getString("var40"));
				pd.put("DXJZMJ", listPd.get(i).getString("var41"));
				pd.put("TCBW", listPd.get(i).getString("var42"));
				pd.put("DSTCBW", listPd.get(i).getString("var43"));
				pd.put("DXTCBW", listPd.get(i).getString("var44"));
				pd.put("ZZMJ", listPd.get(i).getString("var45"));
				pd.put("HS", listPd.get(i).getString("var46"));
				pd.put("JZWSYXZ", listPd.get(i).getString("var47"));
				pd.put("HMCSYQ", listPd.get(i).getString("var48"));
				
				SimpleDateFormat df1=new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
				pd.put("DRSJ",df1.format(System.currentTimeMillis()));
				pd.put("FWLXID","f727c923cfb94566841812b4fb78e4b8");
				Document document = ConvertUtil.convertDocByMap(pd);
				System.out.println(MongoDBUtil.getDbName());
				mongoClient.getDatabase(MongoDBUtil.getDbName()).getCollection("fawen")
						.insertOne(document);
			}
			mongoClient.close();
			/*存入数据库操作======================================*/
			mv.addObject("msg","success");
		}
		mv.setViewName("save_result");
		return mv;
	}
	
	/**从EXCEL导入到数据库选址规条字（道桥）
	 * @param file
	 * @return
	 * @throws Exception
	 */
	@RequestMapping(value="/readExcelXZGTZDQ")
	public ModelAndView readExcelXZGTZDQ(
			@RequestParam(value="planFile",required=false) MultipartFile file
			) throws Exception{
		ModelAndView mv = this.getModelAndView();
		PageData pd = new PageData();
		if (null != file && !file.isEmpty()) {
			String filePath = PathUtil.getClasspath() + Const.FILEPATHFILE;								//文件上传路径
			String fileName =  FileUpload.fileUp(file, filePath, "fawenexcel");							//执行上传
			List<PageData> listPd = (List)ObjectExcelRead.readExcel(filePath, fileName, 1, 0, 0);		//执行读EXCEL操作,读出的数据导入List 2:从第3行开始；0:从第A列开始；0:第0个sheet
	
			/**
			 * var0 :项目唯一码
			 * var1 :文号唯一吗
			 * var2 :项目编号
			 * var3 :受理编号
			 * var4 :受理日期
			 * var5 :发文文号
			 * var6 :发文日期
			 * var7 :证书钢印号
			 * var8 :申办类型
			 * var9 :审批阶段
			 * var10 :工程类别
			 * var11 :项目类型
			 * var12 :承办部门
			 * var13 :经办人
			 * var14 :签批人
			 * var15 :发文类型
			 * var16 :项目名称
			 * var17 :项目位置
			 * var18 :建设单位
			 * var19 :组织机构代码证
			 * var20 :报建人
			 * var21 :联系方式
			 * var22 :设计单位
			 * var23 :规划用地性质
			 * var24 :混合用地性质
			 * var25 :档案编号
			 * var26 :档案盒号
			 * var27 :档案来源
			 * var28 :录入人员
			 * var29 :审核人员
			 * var30 :录入日期
			 * var31 :审核日期
			 * var32 :审核状态
			 * var33 :备注
			 * var34 :道路类型
			 * var35 :道路长度
			 * var36 :红线宽度
			 * var37 :折算建筑面积
			 * var38 :海绵城市要求
	
			 */
			mongoClient = MongoDBUtil.initMongo();
			for(int i=0;i<listPd.size();i++){		
				pd.put("FAWEN_ID", this.get32UUID());										//ID
				pd.put("XMWYM", listPd.get(i).getString("var0"));							
				pd.put("WHWYM", listPd.get(i).getString("var1"));	
				pd.put("XMBH", listPd.get(i).getString("var2"));	
				pd.put("SLBH", listPd.get(i).getString("var3"));		
				pd.put("SLRQ", listPd.get(i).getString("var4"));							
				pd.put("FWWH", listPd.get(i).getString("var5"));	
				pd.put("FWRQ", listPd.get(i).getString("var6"));	
				pd.put("ZSGYH", listPd.get(i).getString("var7"));		
				pd.put("SBLX", listPd.get(i).getString("var8"));							
				pd.put("SPJD", listPd.get(i).getString("var9"));	
				pd.put("GCLB", listPd.get(i).getString("var10"));	
				pd.put("XMLX", listPd.get(i).getString("var11"));		
				pd.put("CBBM", listPd.get(i).getString("var12"));							
				pd.put("JBR", listPd.get(i).getString("var13"));	
				pd.put("QPR", listPd.get(i).getString("var14"));	
				pd.put("FWLX", listPd.get(i).getString("var15"));
				pd.put("XMMC", listPd.get(i).getString("var16"));							
				pd.put("XMWZ", listPd.get(i).getString("var17"));	
				pd.put("JSDW", listPd.get(i).getString("var18"));	
				pd.put("ZZJGDM", listPd.get(i).getString("var19"));		
				pd.put("BJR", listPd.get(i).getString("var20"));							
				pd.put("LXFS", listPd.get(i).getString("var21"));	
				pd.put("SJDW", listPd.get(i).getString("var22"));	
				pd.put("GHYDXZ", listPd.get(i).getString("var23"));		
				pd.put("HHYDXZ", listPd.get(i).getString("var24"));							
				pd.put("DABH", listPd.get(i).getString("var25"));	
				pd.put("DAHH", listPd.get(i).getString("var26"));	
				pd.put("DALY", listPd.get(i).getString("var27"));		
				pd.put("LRRY", listPd.get(i).getString("var28"));							
				pd.put("SHRY", listPd.get(i).getString("var29"));	
				pd.put("LRRQ", listPd.get(i).getString("var30"));	
				pd.put("SHRQ", listPd.get(i).getString("var31"));
				pd.put("SHZT", listPd.get(i).getString("var32"));	
				pd.put("BZ", listPd.get(i).getString("var33"));		
				
				pd.put("DLDJ", listPd.get(i).getString("var34"));							
				pd.put("DLCD", listPd.get(i).getString("var35"));	
				pd.put("HXKD", listPd.get(i).getString("var36"));	
				pd.put("DMXS", listPd.get(i).getString("var37"));		
				pd.put("SJBZ", listPd.get(i).getString("var38"));
				pd.put("HMCSYQ", listPd.get(i).getString("var39"));
				SimpleDateFormat df1=new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
				pd.put("DRSJ",df1.format(System.currentTimeMillis()));
				pd.put("FWLXID","4356c43d648d48208091793b50089340");
				Document document = ConvertUtil.convertDocByMap(pd);
				System.out.println(MongoDBUtil.getDbName());
				mongoClient.getDatabase(MongoDBUtil.getDbName()).getCollection("fawen")
						.insertOne(document);
			}
			mongoClient.close();
			/*存入数据库操作======================================*/
			mv.addObject("msg","success");
		}
		mv.setViewName("save_result");
		return mv;
	}
	
	/**从EXCEL导入到数据库选址规条字（管线）
	 * @param file
	 * @return
	 * @throws Exception
	 */
	@RequestMapping(value="/readExcelXZGTZGX")
	public ModelAndView readExcelXZGTZGX(
			@RequestParam(value="planFile",required=false) MultipartFile file
			) throws Exception{
		ModelAndView mv = this.getModelAndView();
		PageData pd = new PageData();
		if (null != file && !file.isEmpty()) {
			String filePath = PathUtil.getClasspath() + Const.FILEPATHFILE;								//文件上传路径
			String fileName =  FileUpload.fileUp(file, filePath, "fawenexcel");							//执行上传
			List<PageData> listPd = (List)ObjectExcelRead.readExcel(filePath, fileName, 1, 0, 0);		//执行读EXCEL操作,读出的数据导入List 2:从第3行开始；0:从第A列开始；0:第0个sheet
	
			/**
			 * var0 :项目唯一码
			 * var1 :文号唯一吗
			 * var2 :项目编号
			 * var3 :受理编号
			 * var4 :受理日期
			 * var5 :发文文号
			 * var6 :发文日期
			 * var7 :证书钢印号
			 * var8 :申办类型
			 * var9 :审批阶段
			 * var10 :工程类别
			 * var11 :项目类型
			 * var12 :承办部门
			 * var13 :经办人
			 * var14 :签批人
			 * var15 :发文类型
			 * var16 :项目名称
			 * var17 :项目位置
			 * var18 :建设单位
			 * var19 :组织机构代码证
			 * var20 :报建人
			 * var21 :联系方式
			 * var22 :设计单位
			 * var23 :规划用地性质
			 * var24 :混合用地性质
			 * var25 :档案编号
			 * var26 :档案盒号
			 * var27 :档案来源
			 * var28 :录入人员
			 * var29 :审核人员
			 * var30 :录入日期
			 * var31 :审核日期
			 * var32 :审核状态
			 * var33 :备注
			 * var34 :道路类型
			 * var35 :道路长度
			 * var36 :红线宽度
			 * var37 :折算建筑面积
			 * var38 :海绵城市要求
	
			 */
			mongoClient = MongoDBUtil.initMongo();
			for(int i=0;i<listPd.size();i++){		
				pd.put("FAWEN_ID", this.get32UUID());										//ID
				pd.put("XMWYM", listPd.get(i).getString("var0"));							
				pd.put("WHWYM", listPd.get(i).getString("var1"));	
				pd.put("XMBH", listPd.get(i).getString("var2"));	
				pd.put("SLBH", listPd.get(i).getString("var3"));		
				pd.put("SLRQ", listPd.get(i).getString("var4"));							
				pd.put("FWWH", listPd.get(i).getString("var5"));	
				pd.put("FWRQ", listPd.get(i).getString("var6"));	
				pd.put("ZSGYH", listPd.get(i).getString("var7"));		
				pd.put("SBLX", listPd.get(i).getString("var8"));							
				pd.put("SPJD", listPd.get(i).getString("var9"));	
				pd.put("GCLB", listPd.get(i).getString("var10"));	
				pd.put("XMLX", listPd.get(i).getString("var11"));		
				pd.put("CBBM", listPd.get(i).getString("var12"));							
				pd.put("JBR", listPd.get(i).getString("var13"));	
				pd.put("QPR", listPd.get(i).getString("var14"));	
				pd.put("FWLX", listPd.get(i).getString("var15"));
				pd.put("XMMC", listPd.get(i).getString("var16"));							
				pd.put("XMWZ", listPd.get(i).getString("var17"));	
				pd.put("JSDW", listPd.get(i).getString("var18"));	
				pd.put("ZZJGDM", listPd.get(i).getString("var19"));		
				pd.put("BJR", listPd.get(i).getString("var20"));							
				pd.put("LXFS", listPd.get(i).getString("var21"));	
				pd.put("SJDW", listPd.get(i).getString("var22"));	
				pd.put("GHYDXZ", listPd.get(i).getString("var23"));		
				pd.put("HHYDXZ", listPd.get(i).getString("var24"));							
				pd.put("DABH", listPd.get(i).getString("var25"));	
				pd.put("DAHH", listPd.get(i).getString("var26"));	
				pd.put("DALY", listPd.get(i).getString("var27"));		
				pd.put("LRRY", listPd.get(i).getString("var28"));							
				pd.put("SHRY", listPd.get(i).getString("var29"));	
				pd.put("LRRQ", listPd.get(i).getString("var30"));	
				pd.put("SHRQ", listPd.get(i).getString("var31"));
				pd.put("SHZT", listPd.get(i).getString("var32"));	
				pd.put("BZ", listPd.get(i).getString("var33"));		
				
				pd.put("GXLX", listPd.get(i).getString("var34"));							
				pd.put("GXCD", listPd.get(i).getString("var35"));	
				pd.put("SJBZ", listPd.get(i).getString("var36"));		
				pd.put("HMCSYQ", listPd.get(i).getString("var37"));		
				SimpleDateFormat df1=new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
				pd.put("DRSJ",df1.format(System.currentTimeMillis()));
				pd.put("FWLXID","5cef408b328a4dfea51e259082bd7fb9");
				Document document = ConvertUtil.convertDocByMap(pd);
				System.out.println(MongoDBUtil.getDbName());
				mongoClient.getDatabase(MongoDBUtil.getDbName()).getCollection("fawen")
						.insertOne(document);
			}
			mongoClient.close();
			/*存入数据库操作======================================*/
			mv.addObject("msg","success");
		}
		mv.setViewName("save_result");
		return mv;
	}
	
	/**从EXCEL导入到数据库选址规条字（建筑）
	 * @param file
	 * @return
	 * @throws Exception
	 */
	@RequestMapping(value="/readExcelXZGTZJZ")
	public ModelAndView readExcelXZGTZJZ(
			@RequestParam(value="planFile",required=false) MultipartFile file
			) throws Exception{
		ModelAndView mv = this.getModelAndView();
		PageData pd = new PageData();
		if (null != file && !file.isEmpty()) {
			String filePath = PathUtil.getClasspath() + Const.FILEPATHFILE;								//文件上传路径
			String fileName =  FileUpload.fileUp(file, filePath, "fawenexcel");							//执行上传
			List<PageData> listPd = (List)ObjectExcelRead.readExcel(filePath, fileName, 1, 0, 0);		//执行读EXCEL操作,读出的数据导入List 2:从第3行开始；0:从第A列开始；0:第0个sheet
	
			/**
			 * var0 :项目唯一码
			 * var1 :文号唯一吗
			 * var2 :项目编号
			 * var3 :受理编号
			 * var4 :受理日期
			 * var5 :发文文号
			 * var6 :发文日期
			 * var7 :证书钢印号
			 * var8 :申办类型
			 * var9 :审批阶段
			 * var10 :工程类别
			 * var11 :项目类型
			 * var12 :承办部门
			 * var13 :经办人
			 * var14 :签批人
			 * var15 :发文类型
			 * var16 :项目名称
			 * var17 :项目位置
			 * var18 :建设单位
			 * var19 :组织机构代码证
			 * var20 :报建人
			 * var21 :联系方式
			 * var22 :设计单位
			 * var23 :规划用地性质
			 * var24 :混合用地性质
			 * var25 :档案编号
			 * var26 :档案盒号
			 * var27 :档案来源
			 * var28 :录入人员
			 * var29 :审核人员
			 * var30 :录入日期
			 * var31 :审核日期
			 * var32 :审核状态
			 * var33 :备注
			 * var34 :道路类型
			 * var35 :道路长度
			 * var36 :红线宽度
			 * var37 :折算建筑面积
			 * var38 :海绵城市要求
	
			 */
			mongoClient = MongoDBUtil.initMongo();
			for(int i=0;i<listPd.size();i++){		
				pd.put("FAWEN_ID", this.get32UUID());										//ID
				pd.put("XMWYM", listPd.get(i).getString("var0"));							
				pd.put("WHWYM", listPd.get(i).getString("var1"));	
				pd.put("XMBH", listPd.get(i).getString("var2"));	
				pd.put("SLBH", listPd.get(i).getString("var3"));		
				pd.put("SLRQ", listPd.get(i).getString("var4"));							
				pd.put("FWWH", listPd.get(i).getString("var5"));	
				pd.put("FWRQ", listPd.get(i).getString("var6"));	
				pd.put("ZSGYH", listPd.get(i).getString("var7"));		
				pd.put("SBLX", listPd.get(i).getString("var8"));							
				pd.put("SPJD", listPd.get(i).getString("var9"));	
				pd.put("GCLB", listPd.get(i).getString("var10"));	
				pd.put("XMLX", listPd.get(i).getString("var11"));		
				pd.put("CBBM", listPd.get(i).getString("var12"));							
				pd.put("JBR", listPd.get(i).getString("var13"));	
				pd.put("QPR", listPd.get(i).getString("var14"));	
				pd.put("FWLX", listPd.get(i).getString("var15"));
				pd.put("XMMC", listPd.get(i).getString("var16"));							
				pd.put("XMWZ", listPd.get(i).getString("var17"));	
				pd.put("JSDW", listPd.get(i).getString("var18"));	
				pd.put("ZZJGDM", listPd.get(i).getString("var19"));		
				pd.put("BJR", listPd.get(i).getString("var20"));							
				pd.put("LXFS", listPd.get(i).getString("var21"));	
				pd.put("SJDW", listPd.get(i).getString("var22"));	
				pd.put("GHYDXZ", listPd.get(i).getString("var23"));		
				pd.put("HHYDXZ", listPd.get(i).getString("var24"));							
				pd.put("DABH", listPd.get(i).getString("var25"));	
				pd.put("DAHH", listPd.get(i).getString("var26"));	
				pd.put("DALY", listPd.get(i).getString("var27"));		
				pd.put("LRRY", listPd.get(i).getString("var28"));							
				pd.put("SHRY", listPd.get(i).getString("var29"));	
				pd.put("LRRQ", listPd.get(i).getString("var30"));	
				pd.put("SHRQ", listPd.get(i).getString("var31"));
				pd.put("SHZT", listPd.get(i).getString("var32"));	
				pd.put("BZ", listPd.get(i).getString("var33"));	
				
				pd.put("YDMJ", listPd.get(i).getString("var34"));							
				pd.put("RJL", listPd.get(i).getString("var35"));	
				pd.put("JZMD", listPd.get(i).getString("var36"));
				pd.put("LDL", listPd.get(i).getString("var37"));
				pd.put("TCBW", listPd.get(i).getString("var38"));
				pd.put("JZGD", listPd.get(i).getString("var39"));
				pd.put("HMCSYQ", listPd.get(i).getString("var40"));
				
				SimpleDateFormat df1=new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
				pd.put("DRSJ",df1.format(System.currentTimeMillis()));
				pd.put("FWLXID","da2e8025b1454f999d1970b7de49c014");
				Document document = ConvertUtil.convertDocByMap(pd);
				System.out.println(MongoDBUtil.getDbName());
				mongoClient.getDatabase(MongoDBUtil.getDbName()).getCollection("fawen")
						.insertOne(document);
			}
			mongoClient.close();
			/*存入数据库操作======================================*/
			mv.addObject("msg","success");
		}
		mv.setViewName("save_result");
		return mv;
	}
	
	/**从EXCEL导入到数据库地字（道桥管线建筑）
	 * @param file
	 * @return
	 * @throws Exception
	 */
	@RequestMapping(value="/readExcelDZDQGXJZ")
	public ModelAndView readExcelDZDQGXJZ(
			@RequestParam(value="planFile",required=false) MultipartFile file
			) throws Exception{
		ModelAndView mv = this.getModelAndView();
		PageData pd = new PageData();
		if (null != file && !file.isEmpty()) {
			String filePath = PathUtil.getClasspath() + Const.FILEPATHFILE;								//文件上传路径
			String fileName =  FileUpload.fileUp(file, filePath, "fawenexcel");							//执行上传
			List<PageData> listPd = (List)ObjectExcelRead.readExcel(filePath, fileName, 1, 0, 0);		//执行读EXCEL操作,读出的数据导入List 2:从第3行开始；0:从第A列开始；0:第0个sheet
	
			/**
			 * var0 :项目唯一码
			 * var1 :文号唯一吗
			 * var2 :项目编号
			 * var3 :受理编号
			 * var4 :受理日期
			 * var5 :发文文号
			 * var6 :发文日期
			 * var7 :证书钢印号
			 * var8 :申办类型
			 * var9 :审批阶段
			 * var10 :工程类别
			 * var11 :项目类型
			 * var12 :承办部门
			 * var13 :经办人
			 * var14 :签批人
			 * var15 :发文类型
			 * var16 :项目名称
			 * var17 :项目位置
			 * var18 :建设单位
			 * var19 :组织机构代码证
			 * var20 :报建人
			 * var21 :联系方式
			 * var22 :设计单位
			 * var23 :规划用地性质
			 * var24 :混合用地性质
			 * var25 :档案编号
			 * var26 :档案盒号
			 * var27 :档案来源
			 * var28 :录入人员
			 * var29 :审核人员
			 * var30 :录入日期
			 * var31 :审核日期
			 * var32 :审核状态
			 * var33 :备注
			 * var34 :道路类型
			 * var35 :道路长度
			 * var36 :红线宽度
			 * var37 :折算建筑面积
			 * var38 :海绵城市要求
	
			 */
			mongoClient = MongoDBUtil.initMongo();
			for(int i=0;i<listPd.size();i++){		
				pd.put("FAWEN_ID", this.get32UUID());										//ID
				pd.put("XMWYM", listPd.get(i).getString("var0"));							
				pd.put("WHWYM", listPd.get(i).getString("var1"));	
				pd.put("XMBH", listPd.get(i).getString("var2"));	
				pd.put("SLBH", listPd.get(i).getString("var3"));		
				pd.put("SLRQ", listPd.get(i).getString("var4"));							
				pd.put("FWWH", listPd.get(i).getString("var5"));	
				pd.put("FWRQ", listPd.get(i).getString("var6"));	
				pd.put("ZSGYH", listPd.get(i).getString("var7"));		
				pd.put("SBLX", listPd.get(i).getString("var8"));							
				pd.put("SPJD", listPd.get(i).getString("var9"));	
				pd.put("GCLB", listPd.get(i).getString("var10"));	
				pd.put("XMLX", listPd.get(i).getString("var11"));		
				pd.put("CBBM", listPd.get(i).getString("var12"));							
				pd.put("JBR", listPd.get(i).getString("var13"));	
				pd.put("QPR", listPd.get(i).getString("var14"));	
				pd.put("FWLX", listPd.get(i).getString("var15"));
				pd.put("XMMC", listPd.get(i).getString("var16"));							
				pd.put("XMWZ", listPd.get(i).getString("var17"));	
				pd.put("JSDW", listPd.get(i).getString("var18"));	
				pd.put("ZZJGDM", listPd.get(i).getString("var19"));		
				pd.put("BJR", listPd.get(i).getString("var20"));							
				pd.put("LXFS", listPd.get(i).getString("var21"));	
				pd.put("SJDW", listPd.get(i).getString("var22"));	
				pd.put("GHYDXZ", listPd.get(i).getString("var23"));		
				pd.put("HHYDXZ", listPd.get(i).getString("var24"));							
				pd.put("DABH", listPd.get(i).getString("var25"));	
				pd.put("DAHH", listPd.get(i).getString("var26"));	
				pd.put("DALY", listPd.get(i).getString("var27"));		
				pd.put("LRRY", listPd.get(i).getString("var28"));							
				pd.put("SHRY", listPd.get(i).getString("var29"));	
				pd.put("LRRQ", listPd.get(i).getString("var30"));	
				pd.put("SHRQ", listPd.get(i).getString("var31"));
				pd.put("SHZT", listPd.get(i).getString("var32"));	
				pd.put("BZ", listPd.get(i).getString("var33"));	
				
				pd.put("YDMJ", listPd.get(i).getString("var34"));							
				pd.put("TZGLLX", listPd.get(i).getString("var35"));	
				pd.put("TDSYLX", listPd.get(i).getString("var36"));
				pd.put("HMCSYQ", listPd.get(i).getString("var37"));
				
				SimpleDateFormat df1=new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
				pd.put("DRSJ",df1.format(System.currentTimeMillis()));
				pd.put("FWLXID","66c1002c0f7c46198f85caf4e785b108");
				Document document = ConvertUtil.convertDocByMap(pd);
				System.out.println(MongoDBUtil.getDbName());
				mongoClient.getDatabase(MongoDBUtil.getDbName()).getCollection("fawen")
						.insertOne(document);
			}
			mongoClient.close();
			/*存入数据库操作======================================*/
			mv.addObject("msg","success");
		}
		mv.setViewName("save_result");
		return mv;
	}
	
}
